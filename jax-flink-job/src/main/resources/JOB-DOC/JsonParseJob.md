# json提取

Json用于值为json字符串的提取到最外层,如果isRec设置为true则将Json压平(flatten)后放到最外层。正确结果输出到slot 0，失败在slot 1输出原始数据。

假设原始日志如下:

```json
{
  "message" : "{\"a\":1,\"b\":{\"bb01\":21,\"bb02\":22,\"bb03\":{\"cc\":33,\"cc01\":34,\"intarr\":[1,2]},\"strarr\":[\"a\",\"b\"]},\"c\":[{\"c1\":1},{\"c1\":2}]}"
}
```

## 示例1

该例子是一个简单的json提取操作

解析规则:

```json
{
  "sourceField" : "message"
}
```

输出的数据（slot 0）：

```json
{
    "message":"{\"a\":1,\"b\":{\"bb01\":21,\"bb02\":22,\"bb03\":{\"cc\":33,\"cc01\":34,\"intarr\":[1,2]},\"strarr\":[\"a\",\"b\"]},\"c\":[{\"c1\":1},{\"c1\":2}]}",
    "a":1,
    "b":{
        "bb01":21,
        "bb02":22,
        "bb03":{
            "cc":33,
            "cc01":34,
            "intarr":[
                1,
                2
            ]
        },
        "strarr":[
            "a",
            "b"
        ]
    },
    "c":[
        {
            "c1":1
        },
        {
            "c1":2
        }
    ]
}
```

## 示例2

该例子是json提取之后，将嵌套json平铺，链接符为`.`

解析规则:

```json
{
 "sourceField":"message",
 "flatDelimiter":"."
}
```

输出的数据（slot 0）：

```json
{
    "message":"{\"a\":1,\"b\":{\"bb01\":21,\"bb02\":22,\"bb03\":{\"cc\":33,\"cc01\":34,\"intarr\":[1,2]},\"strarr\":[\"a\",\"b\"]},\"c\":[{\"c1\":1},{\"c1\":2}]}",
    "a":1,
    "b.bb01":21,
    "b.bb02":22,
    "b.bb03.cc":33,
    "b.bb03.cc01":34,
    "b.bb03.intarr[0]":1,
    "b.bb03.intarr[1]":2,
    "b.strarr[0]":"a",
    "b.strarr[1]":"b",
    "c[0].c1":1,
    "c[1].c1":2
}
```

## 示例3

该例子将解析后的数据存放到一个目标字段out中

解析规则:

```json
{
 "sourceField":"message",
 "outputField":"out"
}
```
输出的数据（slot 0）：

```json
{
    "message":"{\"a\":1,\"b\":{\"bb01\":21,\"bb02\":22,\"bb03\":{\"cc\":33,\"cc01\":34,\"intarr\":[1,2]},\"strarr\":[\"a\",\"b\"]},\"c\":[{\"c1\":1},{\"c1\":2}]}",
    "out":{
        "a":1,
        "b":{
            "bb01":21,
            "bb02":22,
            "bb03":{
                "cc":33,
                "cc01":34,
                "intarr":[
                    1,
                    2
                ]
            },
            "strarr":[
                "a",
                "b"
            ]
        },
        "c":[
            {
                "c1":1
            },
            {
                "c1":2
            }
        ]
    }
}
```

若解析失败，则会在slot1 中输出原始数据